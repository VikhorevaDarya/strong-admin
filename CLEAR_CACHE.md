# Очистка кэша после обновления

## Проблема

После обновления кода браузер может продолжать использовать старую версию JavaScript из кэша. Это приводит к ошибкам вида:

```
400 Bad Request
expand=warehouse_stocks (старое значение)
```

Вместо правильного:
```
expand=warehouse (новое значение)
```

## Решение

### Способ 1: Жесткая перезагрузка (Hard Reload)

**Chrome / Edge:**
- Windows: `Ctrl + Shift + R` или `Ctrl + F5`
- Mac: `Cmd + Shift + R`

**Firefox:**
- Windows: `Ctrl + Shift + R` или `Ctrl + F5`
- Mac: `Cmd + Shift + R`

**Safari:**
- Mac: `Cmd + Option + R`

### Способ 2: Очистка кэша через DevTools

1. Откройте DevTools (F12)
2. Правой кнопкой по иконке обновления страницы
3. Выберите "Очистить кэш и жесткая перезагрузка" (Empty Cache and Hard Reload)

### Способ 3: Полная очистка кэша браузера

**Chrome:**
1. Откройте `chrome://settings/clearBrowserData`
2. Временной диапазон: "Все время"
3. Отметьте только "Изображения и файлы в кэше"
4. Нажмите "Удалить данные"

**Firefox:**
1. Откройте `about:preferences#privacy`
2. Прокрутите до "Куки и данные сайтов"
3. Нажмите "Удалить данные..."
4. Отметьте только "Кэшированное веб-содержимое"
5. Нажмите "Удалить"

### Способ 4: Режим инкогнито

Откройте приложение в режиме инкогнито:
- Chrome/Edge: `Ctrl + Shift + N` (Windows) или `Cmd + Shift + N` (Mac)
- Firefox: `Ctrl + Shift + P` (Windows) или `Cmd + Shift + P` (Mac)

## Проверка

После очистки кэша проверьте Network вкладку в DevTools:

1. Откройте DevTools (F12)
2. Перейдите на вкладку Network
3. Обновите страницу
4. Найдите запрос к `/api/collections/products/records`
5. Проверьте параметры:
   - ✅ `expand=warehouse` (правильно)
   - ❌ `expand=warehouse_stocks` (старый кэш)

## Для разработчиков

Чтобы избежать проблем с кэшем в будущем:

### Отключить кэш в DevTools

1. Откройте DevTools (F12)
2. Перейдите в Settings (иконка шестеренки)
3. Отметьте "Disable cache (while DevTools is open)"

### Изменить версию в package.json

При каждом значительном обновлении меняйте версию:

```json
{
  "version": "1.0.1"  // было 1.0.0
}
```

### Добавить версионирование к статическим файлам

В production сборке React автоматически добавляет хеш к именам файлов:
```
main.c4a9dbd1.js
```

Это предотвращает проблемы с кэшем на продакшене.

## Автоматическая очистка при разработке

Если вы запускаете dev сервер (`npm start`), он автоматически перезагружает страницу при изменениях. Но если проблемы с кэшем остаются:

1. Остановите dev сервер (`Ctrl + C`)
2. Удалите папку `node_modules/.cache`
   ```bash
   rm -rf node_modules/.cache
   ```
3. Запустите снова
   ```bash
   npm start
   ```

## Проверка текущей версии кода

Чтобы убедиться, что используется новая версия:

1. Откройте Console в DevTools
2. Введите:
   ```javascript
   // Проверить expand конфиг
   console.log(window.location.search);

   // Или посмотрите в Network вкладку последний запрос
   ```

3. Должны увидеть `expand=warehouse` вместо `expand=warehouse_stocks`

## Важно!

После обновления кода **ВСЕГДА** выполняйте жесткую перезагрузку (`Ctrl + Shift + R`) перед тестированием!
