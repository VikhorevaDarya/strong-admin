# Дашборд - Статистика по товарам и складам

## Описание

Главная страница приложения с обзорной статистикой по товарам и складам.

## Расположение

- **URL:** `/` (главная страница)
- **Файл:** `client/src/pages/Dashboard.tsx`
- **Меню:** Первый пункт в меню - "Дашборд"

## Отображаемые данные

### Основные метрики (4 карточки)

1. **Всего товаров** (оранжевая)
   - Общее количество товаров в базе данных
   - Иконка: пакет (Inventory)

2. **Всего складов** (черная)
   - Общее количество складов
   - Иконка: склад (Warehouse)

3. **Общее количество** (зеленая)
   - Сумма всех значений `quantity` товаров
   - Иконка: график роста (TrendingUp)

4. **Общая стоимость** (синяя)
   - Сумма `price × quantity` для всех товаров
   - Формат: российский рубль (₽)
   - Иконка: деньги (AttachMoney)

### Статистика по типам товаров

Левая карточка внизу:
- Список всех типов товаров
- Количество товаров каждого типа
- Процент от общего количества
- Градиентный заголовок: оранжевый

**Пример:**
```
Скутер       15 (75%)
Аксессуар     5 (25%)
```

### Статистика по складам

Правая карточка внизу:
- Список всех складов
- Количество товаров на каждом складе (из поля `products_count`)
- Адрес склада
- Градиентный заголовок: черный

**Пример:**
```
Главный склад          12
ул. Ленина, 1

Дополнительный склад    8
ул. Пушкина, 5
```

## Адаптивность

### Десктоп (md+)
- 4 карточки метрик в ряд
- 2 карточки статистики в ряд (типы товаров | склады)

### Планшет (sm)
- 2 карточки метрик в ряд (2 ряда по 2)
- 2 карточки статистики в ряд

### Мобильный (xs)
- Все карточки в одну колонку
- Полная ширина экрана

## Цветовая схема

| Элемент | Цвет | Градиент |
|---------|------|----------|
| Всего товаров | #FF6B00 (оранжевый) | Да |
| Всего складов | #1a1a1a (черный) | Да |
| Общее количество | #4CAF50 (зеленый) | Да |
| Общая стоимость | #2196F3 (синий) | Да |
| Заголовок "Типы товаров" | #FF6B00 → #FF8C33 | Да |
| Заголовок "Склады" | #1a1a1a → #333333 | Да |

## Загрузка данных

Все данные загружаются асинхронно через PocketBase:

```typescript
// Получение товаров
const products = await pb.collection('products').getFullList({
  fields: 'id,type,price,quantity,warehouse',
});

// Получение складов
const warehouses = await pb.collection('warehouses').getFullList({
  fields: 'id,name,address,products_count',
});
```

### Индикатор загрузки

Пока данные загружаются, отображается:
- Центрированный CircularProgress
- Размер: 60px
- Цвет: #FF6B00 (оранжевый)

### Обработка ошибок

Если данные не загрузились:
```
Не удалось загрузить статистику
```

## Формулы расчета

### Общее количество
```typescript
totalQuantity = products.reduce((sum, product) => sum + (product.quantity || 0), 0);
```

### Общая стоимость
```typescript
totalInventoryValue = products.reduce((sum, product) => {
  return sum + (product.price || 0) * (product.quantity || 0);
}, 0);
```

### Процент по типу товара
```typescript
percentage = (typeCount / totalProducts) * 100;
```

## Автообновление

Дашборд **не** обновляется автоматически. Чтобы увидеть актуальные данные:
- Обновите страницу (F5)
- Или перейдите на другую страницу и вернитесь на дашборд

## Интеграция с меню

**Файл:** `client/src/layout/Menu.tsx`

```tsx
<MenuItemLink
  to="/"
  primaryText="Дашборд"
  leftIcon={<DashboardIcon />}
/>
```

Дашборд - первый пункт меню, открывается при входе в систему.

## Зависимости

- **React Admin:** Title компонент для заголовка страницы
- **Material-UI:** Card, CardContent, CardHeader, Box, Typography, CircularProgress
- **MUI Icons:** InventoryIcon, WarehouseIcon, TrendingUpIcon, AttachMoneyIcon, DashboardIcon
- **PocketBase:** Загрузка данных из коллекций `products` и `warehouses`

## Будущие улучшения

Возможные улучшения дашборда:

1. **Графики:**
   - Круговая диаграмма по типам товаров
   - Столбчатая диаграмма по складам
   - Линейный график изменения стоимости

2. **Автообновление:**
   - Polling каждые N секунд
   - WebSocket для real-time обновлений

3. **Фильтры:**
   - По дате создания товаров
   - По складу
   - По типу товара

4. **Экспорт:**
   - Скачать статистику в PDF
   - Экспорт в Excel

5. **Дополнительные метрики:**
   - Средняя цена товара
   - Самый заполненный склад
   - Товар с наибольшей стоимостью
   - Товары с низким остатком

## Тестирование

Чтобы проверить работу дашборда:

1. Создайте несколько товаров
2. Создайте несколько складов
3. Обновите страницу
4. Проверьте, что:
   - Все метрики отображаются корректно
   - Суммы совпадают с данными в базе
   - Проценты считаются правильно
   - Дашборд адаптивен на мобильном

## Производительность

- Загружаются только необходимые поля (`fields` параметр)
- Нет лишних expand операций
- Все расчеты выполняются на клиенте (быстро)
- Один запрос для products, один для warehouses

## Доступ

Дашборд доступен только **авторизованным пользователям** (требуется вход через PocketBase auth).
